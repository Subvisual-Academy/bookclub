<div class="Books">
  <% if current_user %>
    <%= link_to 'New Book', new_book_path %>
  <% end %>
  <br>

  <% if @selected_user.nil? %>
    <strong> <%= link_to 'All books', books_path %> </strong>
    <%= @books.count %>
  <% else %>
    <%= link_to 'All books', books_path %>
    <%= Book.all.count %>
  <% end %>

  <br>

  <% @users.each do |user| %>
    <% if @selected_user.eql?(user) %>
      <strong><%= link_to user.name, books_path(:user_id => user.id) %> </strong>
    <% else %>
      <%= link_to user.name, books_path(:user_id => user.id) %>
    <% end %>
    <%= distinct_book_mentions(user)%>
    <br>
  <% end %>

  <table class="Table">
    <thead>
      <tr>
        <th>Image</th>
        <th>Title</th>
        <th>Author</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @books.each do |book| %>
        <tr>
          <% if book.image%>
            <td><img src="<%= book.image %>"  alt="book cover"/></td>
          <% else %>
            <td><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Question_mark.svg/585px-Question_mark.svg.png"  alt="unknown book cover"/></td>
          <% end %>

          <td><%= book.title %></td>

          <td><%= book.author || "Unavailable" %></td>

            <td><%= link_to 'Show', book %></td>
          <% if current_user %>
            <td><%= link_to 'Edit', edit_book_path(book) %></td>
            <td><%= link_to 'Destroy', book, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
